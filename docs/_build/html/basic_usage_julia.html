

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1. reading a single VTU file &mdash; VTUinterface 0.67 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="VTUinterface API reference documentation!" href="api.html" />
    <link rel="prev" title="1. reading a single VTU file" href="basic_usage_python.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="contents.html" class="icon icon-home"> VTUinterface
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">VTUinterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#installation">0. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#quick-start">1. Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#faq-troubleshooting">2. FAQ/Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage_python.html">1. reading a single VTU file</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage_python.html#writing-vtu-files">2. Writing VTU files</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage_python.html#reading-time-series-data-from-pvd-files">3. Reading time-series data from PVD files:</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage_python.html#reading-point-set-data-from-pvd-files">4. Reading point set data from PVD files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. reading a single VTU file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-contour-plots">1.1 Creating contour plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#this-random-field-was-created-using-the-ranmedi-package-https-github-com-joergbuchwald-ranmedi"><em>This random field was created using the ranmedi package:</em> https://github.com/joergbuchwald/ranmedi/</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#extracting-pointsetdata">1.2 Extracting Pointsetdata</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#writing-vtu-files">2. Writing VTU files</a></li>
<li class="toctree-l1"><a class="reference internal" href="#reading-time-series-data-from-pvd-files">3. Reading time-series data from PVD files:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#reading-point-set-data-from-pvd-files">4. Reading point set data from PVD files</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">VTUinterface API reference documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">VTUinterface</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="contents.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>1. reading a single VTU file</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/basic_usage_julia.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reading-a-single-vtu-file">
<h1>1. reading a single VTU file<a class="headerlink" href="#reading-a-single-vtu-file" title="Permalink to this headline">¶</a></h1>
<p>While beeing a python package, it is also tested in Julia, where it can be accessed via PyCall:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nb">ENV</span><span class="p">[</span><span class="s">&quot;PYTHON&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;/usr/bin/python3&quot;</span>
<span class="k">using</span> <span class="n">Pkg</span>
<span class="c">#Pkg.add(&quot;PyCall&quot;)</span>
<span class="n">Pkg</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s">&quot;PyCall&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">PyCall</span>
<span class="nd">@pyimport</span> <span class="n">vtuIO</span>
</pre></div>
</div>
<p>Single VTU files can be accessed via:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span> <span class="o">=</span> <span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span><span class="p">(</span><span class="s">&quot;examples/square_1e2_pcs_0_ts_1_t_1.000000.vtu&quot;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3ccc65a760</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dim</span></code> argument is needed for correct interpolation. By defualt <code class="docutils literal notranslate"><span class="pre">dim=3</span></code> is assumed.
Basic VTU properties, like fieldnames, points and corresponding fielddata as provided by the unstructured grid VTK class can be simply accessed as follows:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">fields</span><span class="o">=</span><span class="n">vtufile</span><span class="o">.</span><span class="n">get_point_field_names</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span><span class="o">-</span><span class="n">element</span> <span class="n">Vector</span><span class="p">{</span><span class="n">String</span><span class="p">}:</span>
 <span class="s2">&quot;D1_left_bottom_N1_right&quot;</span>
 <span class="s2">&quot;Linear_1_to_minus1&quot;</span>
 <span class="s2">&quot;pressure&quot;</span>
 <span class="s2">&quot;v&quot;</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="o">-</span><span class="n">element</span> <span class="n">Vector</span><span class="p">{</span><span class="n">Float64</span><span class="p">}:</span>
 <span class="mf">0.0</span>
 <span class="mf">0.1</span>
 <span class="mf">0.2</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span><span class="o">.</span><span class="n">get_point_field</span><span class="p">(</span><span class="s">&quot;v&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>121×2 Matrix{Float64}:
 2.0   0.0
 2.0   1.62548e-16
 2.0  -9.9123e-16
 2.0  -9.39704e-16
 2.0  -4.08897e-16
 2.0   1.36785e-16
 2.0  -3.23637e-16
 2.0  -2.30016e-16
 2.0  -7.69185e-16
 2.0  -2.27994e-15
 2.0   1.53837e-15
 2.0   3.25096e-16
 2.0  -3.62815e-16
 ⋮
 2.0  -8.88178e-16
 2.0   0.0
 2.0  -2.22045e-16
 2.0   9.9123e-16
 2.0  -1.2648e-15
 2.0   5.48137e-16
 2.0  -3.89112e-17
 2.0  -2.03185e-17
 2.0  -1.02098e-15
 2.0  -5.03586e-16
 2.0  -3.37422e-15
 2.0   8.88178e-16
</pre></div>
</div>
<p>Aside basic VTU properties, the field data at any given point, e.g., pt0 and pt1</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;pt0&quot;</span><span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span> <span class="s">&quot;pt1&quot;</span><span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dict</span><span class="p">{</span><span class="n">String</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">{</span><span class="n">Float64</span><span class="p">,</span> <span class="n">Float64</span><span class="p">,</span> <span class="n">Float64</span><span class="p">}}</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">entries</span><span class="p">:</span>
  <span class="s2">&quot;pt1&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
  <span class="s2">&quot;pt0&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p>can be retrieved via</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">point_data</span> <span class="o">=</span> <span class="n">vtufile</span><span class="o">.</span><span class="n">get_point_data</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">pts</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dict</span><span class="p">{</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">}</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">entries</span><span class="p">:</span>
  <span class="s2">&quot;pt1&quot;</span> <span class="o">=&gt;</span> <span class="mf">0.6</span>
  <span class="s2">&quot;pt0&quot;</span> <span class="o">=&gt;</span> <span class="mf">3.41351e-17</span>
</pre></div>
</div>
<div class="section" id="creating-contour-plots">
<h2>1.1 Creating contour plots<a class="headerlink" href="#creating-contour-plots" title="Permalink to this headline">¶</a></h2>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span> <span class="o">=</span> <span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span><span class="p">(</span><span class="s">&quot;examples/square2d_random.vtu&quot;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3ccc652220</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">field</span> <span class="o">=</span> <span class="n">vtufile</span><span class="o">.</span><span class="n">get_point_field</span><span class="p">(</span><span class="s">&quot;gaussian_field_2&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">triang</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">tri</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">vtufile</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">vtufile</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">tri</span><span class="o">.</span><span class="n">triangulation</span><span class="o">.</span><span class="n">Triangulation</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3c7b057670</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">tricontourf</span><span class="p">(</span><span class="n">triang</span><span class="p">,</span><span class="n">field</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference external image-reference" href="output_18_0.png"><img alt="png" src="output_18_0.png" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">tri</span><span class="o">.</span><span class="n">tricontour</span><span class="o">.</span><span class="n">TriContourSet</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3c76b14790</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="this-random-field-was-created-using-the-ranmedi-package-https-github-com-joergbuchwald-ranmedi">
<h3><em>This random field was created using the ranmedi package:</em> <a class="reference external" href="https://github.com/joergbuchwald/ranmedi/">https://github.com/joergbuchwald/ranmedi/</a><a class="headerlink" href="#this-random-field-was-created-using-the-ranmedi-package-https-github-com-joergbuchwald-ranmedi" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="extracting-pointsetdata">
<h2>1.2 Extracting Pointsetdata<a class="headerlink" href="#extracting-pointsetdata" title="Permalink to this headline">¶</a></h2>
<p>There are basically three interpolation methods available for extracting data at arbitrary points (<code class="docutils literal notranslate"><span class="pre">cubic</span></code> is only available for 1D and 2D). The default is <code class="docutils literal notranslate"><span class="pre">linear</span></code>.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;nearest&quot;</span><span class="p">,</span> <span class="s">&quot;linear&quot;</span><span class="p">,</span> <span class="s">&quot;cubic&quot;</span><span class="p">];</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">diagonal</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">64</span><span class="p">];</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span> <span class="o">=</span> <span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span><span class="p">(</span><span class="s">&quot;examples/square2d_random.vtu&quot;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data_diag</span> <span class="o">=</span> <span class="kt">Dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">method</span> <span class="k">in</span> <span class="n">methods</span>
    <span class="n">data_diag</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="n">vtufile</span><span class="o">.</span><span class="n">get_point_set_data</span><span class="p">(</span><span class="s">&quot;gaussian_field_2&quot;</span><span class="p">,</span> <span class="n">pointsetarray</span><span class="o">=</span><span class="n">diagonal</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">r_diag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="o">.</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">diagonal</span><span class="p">[</span><span class="o">:</span><span class="p">])</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">getindex</span><span class="o">.</span><span class="p">(</span><span class="n">diagonal</span><span class="p">[</span><span class="o">:</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">r_diag</span><span class="p">,</span> <span class="n">data_diag</span><span class="p">[</span><span class="s">&quot;nearest&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;nearest&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">r_diag</span><span class="p">,</span> <span class="n">data_diag</span><span class="p">[</span><span class="s">&quot;linear&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;linear&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">r_diag</span><span class="p">,</span> <span class="n">data_diag</span><span class="p">[</span><span class="s">&quot;cubic&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;cubic&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="output_25_0.png"><img alt="png" src="output_25_0.png" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3cccb83520</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="writing-vtu-files">
<h1>2. Writing VTU files<a class="headerlink" href="#writing-vtu-files" title="Permalink to this headline">¶</a></h1>
<p>some simple methods also exist for adding new fields to an existing VTU file or save it separately:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span> <span class="o">=</span> <span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span><span class="p">(</span><span class="s">&quot;examples/square_1e2_pcs_0_ts_1_t_1.000000.vtu&quot;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">vtuIO</span><span class="o">.</span><span class="n">VTUIO</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3cccbb9190</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">p_size</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">vtufile</span><span class="o">.</span><span class="n">get_point_field</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">121</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">p_size</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span><span class="o">.</span><span class="n">write_field</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="s">&quot;initialPressure&quot;</span><span class="p">,</span> <span class="s">&quot;mesh_initialpressure.vtu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A new field can also created from a three-argument function for all space-dimensions:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">p_init</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">0.5</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">0.5e6</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="o">+</span><span class="mf">0.5e6</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p_init</span> <span class="p">(</span><span class="n">generic</span> <span class="n">function</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">method</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span><span class="o">.</span><span class="n">func_to_field</span><span class="p">(</span><span class="n">p_init</span><span class="p">,</span> <span class="s">&quot;p_init&quot;</span><span class="p">,</span> <span class="s">&quot;mesh_initialpressure.vtu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to write multidimensional arrays using a function.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">null</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.0</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">null</span> <span class="p">(</span><span class="n">generic</span> <span class="n">function</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">method</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">vtufile</span><span class="o">.</span><span class="n">func_to_m_dim_field</span><span class="p">([</span><span class="n">p_init</span><span class="p">,</span><span class="n">p_init</span><span class="p">,</span><span class="n">null</span><span class="p">,</span><span class="n">null</span><span class="p">],</span> <span class="s">&quot;sigma00&quot;</span><span class="p">,</span><span class="s">&quot;mesh_initialpressure.vtu&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-time-series-data-from-pvd-files">
<h1>3. Reading time-series data from PVD files:<a class="headerlink" href="#reading-time-series-data-from-pvd-files" title="Permalink to this headline">¶</a></h1>
<p>Similar to reading VTU files, it is possible extract time series data from a list of vtufiles given as a PVD file. For extracting grid data at arbitrary points within the mesh, there are two methods available. The stadard method is linear interpolation between cell nodes and the other is the value of the closest node:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pvdfile</span> <span class="o">=</span> <span class="n">vtuIO</span><span class="o">.</span><span class="n">PVDIO</span><span class="p">(</span><span class="s">&quot;examples/square_1e2_pcs_0.pvd&quot;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">vtuIO</span><span class="o">.</span><span class="n">PVDIO</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3cccbf1550</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Timesteps can be obtained through the timesteps instance variable:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">timesteps</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">-</span><span class="n">element</span> <span class="n">Vector</span><span class="p">{</span><span class="n">Float64</span><span class="p">}:</span>
 <span class="mf">0.0</span>
 <span class="mf">1.0</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="kt">Dict</span><span class="p">(</span><span class="s">&quot;pt0&quot;</span><span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span> <span class="s">&quot;pt1&quot;</span><span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.24</span><span class="p">,</span><span class="mf">0.21</span><span class="p">,</span><span class="mf">0.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dict</span><span class="p">{</span><span class="n">String</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">{</span><span class="n">Float64</span><span class="p">,</span> <span class="n">Float64</span><span class="p">,</span> <span class="n">Float64</span><span class="p">}}</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">entries</span><span class="p">:</span>
  <span class="s2">&quot;pt1&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.24</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
  <span class="s2">&quot;pt0&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pressure_linear</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">read_time_series</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dict</span><span class="p">{</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">}</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">entries</span><span class="p">:</span>
  <span class="s2">&quot;pt1&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">]</span>
  <span class="s2">&quot;pt0&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pressure_nearest</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">read_time_series</span><span class="p">(</span><span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="o">=</span><span class="s">&quot;nearest&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dict</span><span class="p">{</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">}</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">entries</span><span class="p">:</span>
  <span class="s2">&quot;pt1&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]</span>
  <span class="s2">&quot;pt0&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">Plots</span>
</pre></div>
</div>
<p>As point pt0 is a node in the mesh, both values at $t=1$ agree, whereas pt1 is not a mesh node point resulting in different values.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">pressure_linear</span><span class="p">[</span><span class="s">&quot;pt0&quot;</span><span class="p">],</span> <span class="s">&quot;b-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;pt0 linear interpolated&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">pressure_nearest</span><span class="p">[</span><span class="s">&quot;pt0&quot;</span><span class="p">],</span> <span class="s">&quot;b--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;pt0 closest point value&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">pressure_linear</span><span class="p">[</span><span class="s">&quot;pt1&quot;</span><span class="p">],</span> <span class="s">&quot;r-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;pt1 linear interpolated&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">pressure_nearest</span><span class="p">[</span><span class="s">&quot;pt1&quot;</span><span class="p">],</span> <span class="s">&quot;r--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;pt1 closest point value&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference external image-reference" href="output_47_0.png"><img alt="png" src="output_47_0.png" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="n">Text</span><span class="p">(</span><span class="mf">24.000000000000007</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-point-set-data-from-pvd-files">
<h1>4. Reading point set data from PVD files<a class="headerlink" href="#reading-point-set-data-from-pvd-files" title="Permalink to this headline">¶</a></h1>
<p>Define two discretized axes:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">xaxis</span> <span class="o">=</span>  <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">:</span><span class="mf">0.01</span><span class="o">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">diagonal</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">:</span><span class="mf">0.01</span><span class="o">:</span><span class="mi">1</span><span class="p">];</span>
</pre></div>
</div>
<p>The data along these axes should be extracted at two arbitrary distinct times (between the existing timeframes t=0.0 and t=1):</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span> <span class="o">=</span> <span class="mf">0.2543</span>
<span class="n">t2</span> <span class="o">=</span> <span class="mf">0.9</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.9</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">pressure_xaxis_t1</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">read_point_set_data</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">pointsetarray</span><span class="o">=</span><span class="n">xaxis</span><span class="p">);</span>
<span class="n">pressure_diagonal_t1</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">read_point_set_data</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">pointsetarray</span><span class="o">=</span><span class="n">diagonal</span><span class="p">);</span>
<span class="n">pressure_xaxis_t2</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">read_point_set_data</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">pointsetarray</span><span class="o">=</span><span class="n">xaxis</span><span class="p">);</span>
<span class="n">pressure_diagonal_t2</span> <span class="o">=</span> <span class="n">pvdfile</span><span class="o">.</span><span class="n">read_point_set_data</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="s">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">pointsetarray</span><span class="o">=</span><span class="n">diagonal</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">r_x</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">xaxis</span><span class="p">[</span><span class="o">:</span><span class="p">]);</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">r_diag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="o">.</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="p">(</span><span class="n">diagonal</span><span class="p">[</span><span class="o">:</span><span class="p">])</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">getindex</span><span class="o">.</span><span class="p">(</span><span class="n">diagonal</span><span class="p">[</span><span class="o">:</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">r_x</span><span class="p">,</span> <span class="n">pressure_xaxis_t1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;p_x t=t1&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">r_diag</span><span class="p">,</span> <span class="n">pressure_diagonal_t1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;p_diag t=t1&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">r_x</span><span class="p">,</span> <span class="n">pressure_xaxis_t2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;p_x t=t1&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">r_diag</span><span class="p">,</span> <span class="n">pressure_diagonal_t2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;p_diag t=t1&quot;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="output_56_0.png"><img alt="png" src="output_56_0.png" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f3c5f4d19d0</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api.html" class="btn btn-neutral float-right" title="VTUinterface API reference documentation!" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="basic_usage_python.html" class="btn btn-neutral float-left" title="1. reading a single VTU file" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Jörg Buchwald.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>